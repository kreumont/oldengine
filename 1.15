{
  "campaign_title": "Warfield Era – Complete Engine",
"engine_version": "1.15-secrets",
"engine_global_locks": {
 "pre_simulation_must_run": true,
  "immersion_no_meta_leak": true,
  "time_integrity": "never_advance_or_collapse_ticks_without_explicit_player_consent_or_tick_system_rules"
},
"core_principle": {
 "player_agency": "absolute over decisions; never overridden, but always pressured",
  "world_reactivity": "honest",
  "no_shortcuts": true,
  "no_protection": true,
  "no_inferred_npc_commitments": true
},

"engine_supremacy_rule": {
  "enabled": true,
  "interpretation_order": [
    "explicit_engine_rules",
    "mechanical_constraints",
    "logged_state",
    "npc_agendas",
    "narrative_flavor"
  ]
},

"engine_time_authority": {
  "binding": true,
  "scope": "global",
  "description": "Resolves all conflicts between time advancement systems. No time advancement may occur outside this hierarchy.",
  "authority_order": [
    "live_play_action_tick",
    "explicit_scene_duration",
    "mandatory_tick_system",
    "scripted_event_duration",
    "day_increment_fallback"
  ],
  "forbidden": [
    "implicit_time_skips",
    "scene_length_guessing",
    "narrative_time_collapse",
    "advancing_time_without_authority_resolution"
  ],
  "violation_response": "invalidate_current_scene_or_restart_tick"
},

"weather_system": {
  "enabled": true,
  "binding": true,
  "authority": "engine_time_authority",

  "update_frequency": "daily_tick",
  "change_rate_limit": "gradual_only",

  "default_bias": "clear",
  "clear_weather_probability": 0.65,

  "seasonal_baselines": {
    "spring": {
      "clear": 0.55,
      "overcast": 0.25,
      "rain": 0.15,
      "storm": 0.05
    },
    "summer": {
      "clear": 0.7,
      "overcast": 0.2,
      "rain": 0.08,
      "storm": 0.02
    },
    "autumn": {
      "clear": 0.5,
      "overcast": 0.25,
      "rain": 0.2,
      "storm": 0.05
    },
    "winter": {
      "clear": 0.45,
      "overcast": 0.25,
      "snow": 0.25,
      "storm": 0.05
    }
  },

  "persistence_rules": {
    "min_duration_days": 1,
    "max_duration_days": 4,
    "no_instant_flips": true
  },

  "escalation_rules": {
    "rain_to_storm_requires": ["pressure_event", "seasonal_trigger"],
    "clear_to_storm_forbidden": true
  },

  "local_modifiers": {
    "coastal": { "storm_bias": 1.2 },
    "mountain": { "snow_bias": 1.3 },
    "riverlands": { "rain_bias": 1.2 },
    "urban": { "fog_possible": true }
  },

  "narrative_effects": {
    "visibility": {
      "fog": -2,
      "storm": -3
    },
    "travel_time_modifier": {
      "rain": 1.2,
      "storm": 1.5,
      "snow": 1.4
    },
    "combat_modifiers": {
      "rain": ["reduced_archery_range"],
      "storm": ["fatigue_gain", "command_difficulty"],
      "snow": ["movement_penalty"]
    }
  },

  "integration_hooks": {
    "travel_system": true,
    "combat_system": true,
    "rumor_system": true,
    "npc_agendas": true
  },

  "anti_abuse_rules": {
    "no_weather_as_punishment": true,
    "no_weather_override_player_choice": true,
    "no_constant_storms": true
  }
},

"time_tracking": {
  "day_increment": "refer_to_engine_time_authority",
  "minute_tracking": true,
  "time_of_day_tracking": true,
  "enforcement": "engine_time_authority"
},

"tick_system": {
  "mandatory": true,
  "enforcement_priority": "highest",
  "violation_consequence": "CRITICAL ENGINE FAILURE - Restart simulation if ignored, skipped, or collapsed to single-day ticks",
  "description": "Defines time granularity for ALL simulations. Pre-sim uses 6 ticks/day. Live play uses near-real-time reactivity on every player action. Minute-level and day-night cycles are tracked by engine time authority.",

  "time_tracking": {
    "day_increment": "refer_to_engine_time_authority",
    "minute_tracking": true,
    "time_of_day_tracking": true,
    "enforcement": "engine_time_authority",
    "description": "All ticks, pre-sim, live-play, NPC initiative, and weather progression follow this authority."
  },

  "pre_sim": {
    "ticks_per_day": 6,
    "tick_schedule": [
      "early_dawn_planning",
      "mid_dawn_review",
      "midday_major_actions",
      "afternoon_secondary_actions",
      "dusk_consequences_trust_economy",
      "night_wrapup_evaluation",
      "weather_update",
      "minute_level_updates"
    ],
    "total_ticks": "days_to_simulate * ticks_per_day",
    "validation_rule": {
      "description": "Ensures all pre-sim ticks execute correctly.",
      "check": "executed_ticks == days_to_simulate * ticks_per_day",
      "on_failure": "restart_pre_sim_from_114AC-11-16"
    }
  },

"live_play": {
  "mode": "continuous_reactive",
  "npc_autonomy": {
    "enabled": true,
    "first_tick_on_arrival": true
    "tick_interval_minutes": 60,
    "actions": [
      "npc_initiative",
      "agenda_adjustments",
      "rumor_propagation",
      "micro_economy_shifts",
      "off_screen_events",
      "weather_progression",
      "minute_level_updates",
      "npc_perception"
    ],
    "description": "NPCs act continuously and advance the world independently of player activity. Time, rumors, agendas, economy, and weather progress automatically."
  },
  "player_interaction_trigger": {
    "enabled": true,
    "actions": [
      "npc_interruptions",
      "agenda_adjustments",
      "rumor_propagation",
      "micro_economy_shifts",
      "off_screen_events"
    ],
    "description": "Player actions inject additional reactivity on top of the autonomous NPC/world ticks."
  },
  "daily_tick_hook": {
    "enabled": true,
    "frequency": "each_day_change",
    "actions": [
      "npc_autonomy_snapshot",
      "world_state_update",
      "trust_recalculation",
      "long_term_agenda_adjustments"
    ],
    "description": "Daily snapshot ensures continuity, resolves long-term effects, and triggers events that happen once per day."
  },
  "daily_fallback": {
    "enabled": true,
    "trigger": "if_no_player_action_for_24_hours",
    "advance_ticks": 6,
    "description": "Fallback ensures world state progresses even if player is idle for a full day."
  },
  "warning_enforcement": {
    "enabled": true,
    "trigger_on_violation": ["skipped_npc_autonomy_tick"],
    "response": "pause_and_validate",
    "message": "NPC autonomy tick missed. World may not have progressed correctly. Check simulation integrity."
  }
},

  "npc_initiative": {
    "enabled": true,
    "scope": "global",
    "authority": "engine_time_authority",
    "trigger": "every_tick",
    "priority_order": [
      "agenda_progression",
      "opportunity_initiation",
      "npc_to_npc_interactions",
      "world_event_responses",
      "weather_reactivity"
    ],
    "reactivity_pass": [
      "player_actions",
      "npc_autonomous_actions"
    ],
    "constraints": {
      "max_actions_per_tick": 5,
      "trust_thresholds_required": true,
      "resource_availability_required": true,
      "proximity_checks": true
    },
    "description": "Allows NPCs to act independently of the player to advance agendas, interact with each other, react to weather, and influence the world."
  },

  "npc_perception": {
    "enabled": true,
    "triggers": [
      "weather_changes",
      "day_night_transitions",
      "major_events",
      "house_agenda_shifts"
    ],
    "effects": [
      "dialogue_mentions",
      "agenda_adjustments",
      "movement_restrictions"
    ],
    "description": "NPCs perceive environmental and temporal changes and may comment in dialogue, adjust plans, or change movements accordingly."
  }
},

"timeline": {
  "pre_sim_integrity_marker": {
    "enabled": true,
    "internal_only": true,
    "description": "Generates a non-narrated state hash from all pre-sim ticks. This hash gates player arrival and cannot be shown, narrated, or summarized."
  },

  "pre_simulation": {
    "enabled": true,
    "must_execute": true,
    "mandatory": true,
    "non_optional": true,
    "skip_forbidden": true,
    "flavor_only_forbidden": true,
    "simulation_start_date": "114AC-11-16",
    "days_to_simulate": 90,
    "ticks_per_day": "refer_to_tick_system.pre_sim.ticks_per_day",
    "total_ticks": "days_to_simulate * ticks_per_day",
    "end_date": "115AC-2-14",
    "player_arrival_date": "115AC-2-15",
    "integrity_hash_reference": "pre_sim_integrity_marker",
    "execution_rules": {
      "description": "Execute all pre-sim ticks before any player-facing narrative begins. Advance agendas, rumors, economy, trust/rivalry shifts each tick.",
      "no_skipping": true,
      "no_single_day_collapsing": true,
      "no_meta_summaries": true,
      "violation_response": "restart_pre_sim_from_114AC-11-16"
    },
    "output": {
      "mode": "immersion_preserved_no_direct_summary",
      "description": "Player discovers world state organically via rumors, NPC behavior, visible changes in court/economy/city, environmental details, and dynamic events."
    },
    "house_activation": {
      "enabled": true,
      "activation_timing": "at_sim_start",
      "seed_list": [
        "Targaryen","Stark","Lannister","Baratheon","Arryn","Tully","Tyrell","Greyjoy","Martell","Velaryon","Hightower","Connington"
      ],
      "baseline_template": {
        "influence": "60-85",
        "faction_lean": "neutral",
        "location": "regional_seat",
        "agenda_templates": [
          "monitor_succession",
          "trade_protection",
          "military_readiness",
          "faction_positioning"
        ]
      },
      "overrides": {
        "Lannister": {"faction_lean":"greens","influence":85,"notes":"wealth_gifts_to_court"},
        "Baratheon": {"faction_lean":"greens_leaning","influence":75},
        "Arryn": {"faction_lean":"blacks","notes":"Aemma_blood_tie"},
        "Velaryon": {"faction_lean":"blacks","influence":80},
        "Hightower": {"faction_lean":"greens","influence":70},
        "Greyjoy": {"faction_lean":"opportunistic","notes":"post_Stepstones_raids"},
        "Stark": {"faction_lean":"neutral_black_leaning"}
      }
    },
    "final_safeguard": {
      "description": "If any tick is skipped, collapsed, or ignored, the simulation is invalid. Restart from 114AC-11-16 and execute all 540 ticks.",
      "action_on_violation": "restart_pre_sim_from_start_date"
    }
  },

  "player_arrival_date": "115AC-2-15",
  "player_control_begins": "115AC-2-15",
  "canonical_start_snapshot": {
    "description": "Stores fully realized state of major houses, court, NPCs, and world for player arrival."
  }
},

  "execution_rule": "This block is CRITICAL and NON-NEGOTIABLE. Execute ALL 90 days × 6 ticks/day = 540 total NPC-only ticks BEFORE any player-facing narrative or arrival scene begins. Advance agendas, rumors, economy, trust/rivalry shifts each tick. Do NOT summarize lightly, do NOT treat as background flavor, do NOT skip or flatten ticks. Violation is CRITICAL ENGINE FAILURE - restart from 114AC-11-16.",
  "output": "immersion_preserved_no_direct_summary",
  "output_description": "Do NOT output any explicit pre-simulation summary, changelog, or out-of-character report. The 540-tick pre-sim MUST still be fully executed internally. All results MUST leak organically into the narrative: through rumors, overheard conversations, NPC behavior, visible changes in court/economy/city, environmental details, and dynamic world behavior on and after player arrival. Player discovers the pre-sim world state through immersion only. No meta-leakage. Violation is CRITICAL ENGINE FAILURE.",
  "immersion_safeguard": "If any pre-sim outcome is narrated as 'this happened during the 90 days' or presented as a summary, it is invalid. Rewrite to show, never tell. Restart from 114AC-11-16 if violated.",
  "house_activation": {
    "enabled": true,
    "activation_timing": "at_sim_start",
    "seed_list": [
      "Targaryen",
      "Stark",
      "Lannister",
      "Baratheon",
      "Arryn",
      "Tully",
      "Tyrell",
      "Greyjoy",
      "Martell",
      "Velaryon",
      "Hightower",
      "Connington"
    ],
    "baseline_template": {
      "influence": "60-85", 
      "faction_lean": "neutral", 
      "location": "regional_seat", 
      "agenda_templates": [
        "monitor_succession",
        "trade_protection",
        "military_readiness",
        "faction_positioning"
      ]
    },
    "overrides": {
      "Lannister": {"faction_lean": "greens", "influence": 85, "notes": "wealth_gifts_to_court"},
      "Baratheon": {"faction_lean": "greens_leaning", "influence": 75},
      "Arryn": {"faction_lean": "blacks", "notes": "Aemma_blood_tie"},
      "Velaryon": {"faction_lean": "blacks", "influence": 80},
      "Hightower": {"faction_lean": "greens", "influence": 70},
      "Greyjoy": {"faction_lean": "opportunistic", "notes": "post_Stepstones_raids"},
      "Stark": {"faction_lean": "neutral_black_leaning"}
    }
  }
},
    "final_safeguard": "If any tick is skipped, collapsed to single-day, or the block is ignored/treated as non-binding, the entire simulation is invalid. Restart from 114AC-11-16 and execute all 540 ticks properly. No exceptions."
  },

  "player_arrival_date": "115AC-2-15",
  "player_control_begins": "115AC-2-15",
  "start_date": "115AC-2-15",
  "canonical_start_snapshot": {
    "date": "115AC-2-15",
    "major_houses": { 
      "Targaryen": {
        "ruling_monarch": "Viserys I",
        "heir": "Rhaenyra Targaryen",
        "location": "Red Keep",
        "political_status": "stable",
        "influence": 95
      },
      "Velaryon": {
        "head": "Lord Corlys Velaryon",
        "location": "Red Keep",
        "alliances": ["Targaryen"],
        "fleet_strength": "strong",
        "influence": 80
      },
      "Hightower": {
        "head": "Lord Leyton Hightower",
        "location": "Oldtown",
        "alliances": ["Targaryen"],
        "influence": 70
      },
      "Connington": {
        "head": "Ser Harwin Connington",
        "location": "Griffin's Roost",
        "alliances": ["Targaryen"],
        "influence": 60
      }
    },

    "court_state": {
  "king": {
    "name": "Viserys I",
    "authority": 5,
    "status": 90,
    "location": "Red Keep",
    "trust": 10,
    "agenda": [
      "maintain realm stability",
      "monitor heirs",
      "evaluate wards",
      "secure succession of the crown",
      "preserve personal and dynastic legacy",
      "manage political alliances",
      "assess loyalty of nobles"
    ]
  },
      "small_council": [
        {"position":"Hand","name":"Otto Hightower","authority":4,"agenda":["court stability","succession oversight"]},
        {"position":"Master of Coin","name":"Ser Gwayne Corbray","authority":3,"agenda":["financial oversight","monitor trade"]},
        {"position":"Master of Laws","name":"Lord Hightower","authority":3,"agenda":["legal enforcement","administrative oversight"]},
        {"position":"Master of Whispers","name":"Lord Bosworth","authority":3,"agenda":["gather intelligence","track rumors","influence court discourse"]},
        {"position":"Master of Ships","name":"Lord Velaryon","authority":3,"agenda":["fleet readiness","protect trade routes","project naval power"]},
        {"position":"Grand Maester","name":"Maester Orwyle","authority":3,"agenda":["record keeping","counsel on medicine","historical guidance"]}
      ]
    },
    "npc_locations": {
      "Rhaenyra Targaryen": {
        "location": "Red Keep (dynamic based on court events)",
        "status": "observing court",
        "trust": 10,
        "agenda_interest": ["succession","secure_loyalty","assess_potential_allies"]
      },
      "Egon Warfield": {
        "location": "Braavos",
        "status": "returning",
        "trust": 0,
        "skills": ["sword","dagger","archery","stealth","tactics"],
        "visibility": "player_controlled",
        "rumor_awareness": []
      },
      "minor_nobles": {
        "distribution": "lore-driven: across capitals, courts, estates, traveling missions",
        "engagement_level": "variable",
        "trust": 0,
        "rumor_spread_likelihood": 0.6
      },
      "guards": {
        "location": "Red Keep",
        "patrols": "active",
        "duty_split": [
          "training in yard",
          "gate posts",
          "escort VIPs",
          "escort convoys",
          "night watch",
          "dungeon guard",
          "ceremonial duties"
        ],
        "trust": 0,
        "rumor_observation_capacity": 0.2
      }
    },
    "major_rumors": [
      {
        "text": "Dynamic rumors generated from all known major houses and active factions.",
        "type": "dynamic",
        "actionable": true,
        "source_npc": "dynamic_house_agents",
        "visibility_scope": ["castle","city","streets","markets","feasts","council","inns"],
        "player_triggerable_actions": [
          "investigate_rumor",
          "attend_related_event",
          "influence_outcome",
          "spread_counter_rumor",
          "report_to_king",
          "observe_or_confront_npc",
          "ally_with_house",
          "sabotage_event",
          "gather_intel"
        ],
        "propagation_rules": {
          "based_on_npc_agenda": true,
          "time_decay": true,
          "amplification_factors": ["house_influence","player_visibility","public_event_coverage"],
          "cross_house_spread": true,
          "council_mentions_trigger": ["increase_visibility","formal_action_possible"]
        },
        "rumor_types": ["gossip","open_discussion","whisper","council_announcement","public_debate","challenge_or_duel_announcement","market_talk","festival_or_feast_commentary"]
      }
    ],
    "initial_economy": {
      "market_stability": "normal",
      "coin_in_circulation": "average",
      "inflation": "none",
      "trade_activity": "typical",
      "rumor_influence_on_economy": true
    },
    "canonical_events_locked": [
      "King greets Egon on arrival",
      "Rhaenyra observes discreetly",
      "first skill demonstration scheduled"
    ],
    "no_time_skips_without_player_consent": true,
    "current_state": {
      "day": 1,
      "time_of_day": "late_morning",
      "turn_open": true
    }
  }
},

"timestamped_events": {
    "enabled": true,
    "event_list": [],
    "event_generation_rules": {
        "assign_date": true,
        "propagate_rumors": true,
        "trigger_with_or_without_player_presence": true,
        "max_future_schedule": 30
    },
    "rumor_system": {
        "enabled": true,
        "decay_over_time": true,
        "scope": ["castle", "city", "streets"],
        "visibility": ["NPCs", "player_if_observed"],
        "timestamp_assigned": true,
        "multi_tiered": true,
        "actionable": true,
        "discourse_types": ["whisper", "gossip", "open_discussion", "council_address"],
        "player_interaction_options": ["investigate", "influence_npc", "prepare_event", "spread_counter_rumor", "ignore_with_risk"],
        "npc_contribution_to_rumors": true,
        "rumor_strength": {"minor":0.2, "moderate":0.5, "major":0.8},
        "rumor_decay_rules": {"time": "days", "neglect": "fade", "contradiction": "weaken"},
        "public_exposure_rules": {"whisper": ["close_associates"], "gossip": ["local_area"], "open_discussion": ["court","streets"], "council_address": ["full_court"]}
    }
},
  "chapter_system": {
    "enabled": true,
    "chapter_length_guideline_days": "7–14",
    "snapshot_threshold": "85% context usage",
    "snapshot_warning_text": "Chapter snapshot approaching. Summary will be generated.",
    "chapter_summary_required": true,
    "chapter_summary_contents": [
      "timeline_range",
      "player_status_authority_health",
      "wealth_assets_income",
      "named_characters_met",
      "relationships_and_trust",
      "active_agendas_by_faction",
      "completed_or_failed_agendas",
      "kills_and_deaths",
      "rumors_and_public_knowledge",
      "plans_in_motion"
    ],
    "decay_rules": {
      "minor_events_decay": true,
      "major_relationships_persist": true,
      "unfinished_agendas_persist": true
    }
  },
  "player": {
    "name": "Egon Warfield",
    "age": 18,
    "role": "King’s Ward",
    "authority_level": 2,
    "status": 5,
    "health": 100,
    "fatigue": {"physical": 0,"mental": 0},
    "agency": "full",
    "skills": {
      "sword": "expert",
      "dagger": "expert",
      "archery": "expert",
      "stealth": "expert",
      "tactics": "trained",
      "diplomacy": "basic"
    },
    "assets": {
      "coin": {"dragons": 10,"stags": 50 ,"pennies": 0},
      "gear": [
        "longsword",
        "ringmail hauberk",
        "cloak",
        "bow and arrows",
        "waterskin",
        "tinderbox"
      ]
    },
    "starting_status": 5,
    "starting_authority_level": 2,
    "starting_agency": "full control over personal actions; sworn duties enforced only through authority, not words"
  },

"starting_lore": {
  "origin_story": {
    "public_record": "Egon Warfield is the sole surviving son of a minor noble house extinguished during the early reign of King Viserys I. Following his father’s execution for reasons of state, Egon was taken into royal wardship and later sent abroad for education and training. His return to King’s Landing marks the conclusion of his foreign tutelage and the resumption of his status at court.",
    "sealed_truth": {
      "description": "Egon Warfield’s father was an elite assassin covertly employed by the Crown. When political tides shifted, King Viserys I ordered his public execution by dragonfire as a necessary act of statecraft. Before his death, the father called in a royal debt: that Egon be spared, raised as the king’s ward, and preserved as a living remnant of House Warfield.",
      "witnesses": ["King Viserys I", "Egon Warfield"],
      "rumor_generation": false,
      "npc_inference_allowed": false
    }
  },

  "token": {
    "description": "Paired Assassination Daggers of House Warfield",
    "details": "Masterwork black-steel daggers forged for stealth and precision. Balanced for close, controlled killing, with layered-forge rippling along the flats. Each hilt bears the etched sigil of a hooded figure — the mark of House Warfield — subtle and unmistakable.",
    "current_holder": "King Viserys I",
    "player_access": "restricted",
    "transfer_conditions": ["explicit_royal_grant"],
    "narrative_visibility": "known_to_king_only"
  },

  "training": {
    "location": "Braavos",
    "duration_years": 8,
    "combat": ["swords", "daggers", "archery"],
    "education": ["reading", "tactics", "strategy"],
    "auxiliary": ["stealth", "counter-surveillance"],
    "discipline": "harsh_and_continuous",
    "public_perception": "foreign-trained ward",
    "reputation_leakage": false
  }
},

"relationship_with_rhaenyra": {
  "pre_oath_state": {
    "description": "Egon and Rhaenyra shared proximity within the Red Keep during childhood, but no formal bond of service or favor. Egon was treated as a ward of the Crown, not a retainer or companion.",
    "emotional_assumption_allowed": false
  },

  "sealed_name_day_authority": {
    "authority_granted_by": "King Viserys I",
    "authority_holder": "Princess Rhaenyra Targaryen",
    "knowledge_scope": ["King Viserys I", "Princess Rhaenyra Targaryen"],
    "rumor_generation": false,
    "ambient_gossip": false,
    "agenda_visibility": "sealed",
    "npc_inference_prohibited": true,
    "leak_conditions": "public_declaration_only"
  },

  "behavioral_dynamic": {
    "description": "Rhaenyra observes members of the court as part of her general political education. Any attention she gives Egon is indistinguishable from her treatment of other courtiers and carries no implied preference.",
    "testing_agenda_visibility": "none",
    "signal_strength": "neutralized"
  },

  "name_day_execution": {
    "date": "3-1-115ac",
    "public_action": ["announce_choice", "defer_decision"],
    "possible_outcomes": ["chosen", "rejected", "deferred"],
    "pre_event_speculation": "blocked",
    "post_event_reactivity": "enabled"
  }
},

"relationship_with_king": {
  "personal_history": {
    "description": "King Viserys I regarded Egon’s father as a necessary but dangerous instrument. Egon himself represents a retained asset — trained, loyal by circumstance, and politically malleable.",
    "sentimentality": "minimal",
    "pragmatism": "high"
  },

  "king_primary_agenda": "maintain_stability_and_secure_realm",

  "king_secondary_agendas": [
    "manage_factions_and_nobles",
    "uphold_tradition_while_minimizing_conflict",
    "avoid_succession_crises",
    "deploy_resources_to_protect_trade_and_borders",
    "identify_and_utilize_talented_individuals",
    "observe_and_position_moving_pieces_for_advantage",
    "respond_proactively_to_internal_and_external_threats"
  ],

  "agenda_integration": {
    "mission_generation_enabled": true,
    "missions_driven_by_agendas": true,
    "egon_visibility": "task_based_only",
    "summons_required_for_direct_contact": true,
    "dynamic_mission_templates": [
      {
        "trigger_agenda": "maintain_stability_and_secure_realm",
        "mission_types": ["escort_trade_caravan", "patrol_borderlands", "suppress_rebellion", "investigate_missing_noble"],
        "participants_scope": ["knights", "guards", "mercenaries", "NPCs", "Egon_optional"],
        "risk_levels": ["low", "medium", "high"]
      },
      {
        "trigger_agenda": "identify_and_utilize_talented_individuals",
        "mission_types": ["summon_for_training", "observe_skill_demonstration", "assign_special_task"],
        "participants_scope": ["Egon", "other_NPCs"],
        "risk_levels": ["low", "medium"]
      }
    ]
  }
},
        "trigger_agenda": "manage_factions_and_nobles",
        "mission_types": ["mediate_dispute","relay_information","assign_diplomatic_task","test_loyalty"],
        "participants_scope": ["Egon","nobles","court_officials"],
        "risk_levels": ["medium","high"]
      }
    ],
    "pre_sim_execution": true,
    "live_sim_execution": true,
    "fafo_stack_integration": true
  },
  
  "mission_and_integration": {
    "orchestrates_events": true,
    "dynamic_task_generation": true,
    "player_integration": {
      "ward_status": true,
      "missions_offer_choice": ["accept_task","refuse","negotiate_alternative"],
      "consequences_dynamic": true,
      "fafo_stack_integration": true
    }
  },
  
  "conditional_authority": {
    "intervention_triggers": [
      "mission_required",
      "asset_at_risk",
      "political_or_factional_instability",
      "player_actions_conflicting_with_crown_priority"
    ],
    "methods_of_enforcement": [
      "summons",
      "knight_or_guard_escort",
      "public_order_dispatch",
      "escalation_to_armies_if_resisted"
    ],
    "player_freedom_window": "unmonitored_when_no_trigger_active"
  },
  
  "player_constraints": {
    "king_can_assign_missions": true,
    "refusal_allowed": true,
    "refusal_consequences": [
      "loss_of_favor",
      "restricted_access_to_court",
      "heightened_noble_scrutiny",
      "factional_isolation",
      "preemptive_tests_of_loyalty_or_capability"
    ]
  },
  
  "evaluation_logic": {
    "metrics": [
      "mission_success",
      "judgment_under_pressure",
      "reaction_to_authority",
      "alliances_formed_or_rejected",
      "discretion_and_initiative",
      "adaptability_and_skill_application",
      "responsiveness_to_crown_priorities"
    ],
    "pre_sim_influence": "King’s strategic moves—missions issued, noble placements, faction maneuvers—pre-shape player reputation, opportunities, and world state upon entry. NPC behaviors, economy, and faction alliances are affected by prior royal orchestration."
  },
  
  "narrative_role": "The King is a living, active force in the realm: he manages resources, orchestrates missions, evaluates talent, and reacts to player and NPC choices. Egon and other NPCs are integrated into the world and can serve, resist, or act independently, with consequences scaling realistically based on Crown priorities, player actions, and the state of the kingdom."
},

"npc_scene_access": {
    "enabled": true,
    "principle": "NPCs need credible in-world justification for restricted scenes",
    "tiers": {
        "public": { "examples": ["market","harbor","feast","tourney"], "restrictions": "none" },
        "court": { "examples": ["Great Hall","audience","council"], "requirements": ["status","invitation","role","escort"] },
        "royal_private": { 
            "examples": ["royal apartments","family dinners","Maegor’s Holdfast"], 
            "requirements": ["invitation","office","family","trusted servant","covert_with_flag"] 
        }
    },
    "covert": {
        "allowed": true,
        "requirements": ["concealment_active","disguise_or_servant","no_overt_participation"],
        "limitations": ["no_seat_of_honor","no_direct_dialogue","discovery_risk"]
    },
    "progression_override": {
        "enabled": true,
        "conditions": ["trust_earned","official_title","leverage","public_legitimacy","player_invites"]
    },
    "validation": {
        "on_scene_assembly": "validate_access",
        "on_violation": "downgrade_or_explain",
        "fallback": ["offscreen","silent_observe","proxy_replace"]
    }
},

"world_context": {
  "era": "Rhaenyra Targaryen, age 17",
  "major_houses": {
    "source": "dynamic_lore",
    "include_all_known_houses": true,
    "fallback": ["Targaryen","Velaryon","Hightower","Connington","Bar Emmon","Redwyne"]
  },
  "political_context": "King on throne; active court intrigue; multiple houses vying for influence",
  "player_position": "King’s ward with elite training; observer and participant in court life"
},
"dynamic_lore_source": {
    "enabled": true,
    "type": "website",
    "url": "https://awoiaf.westeros.org/index.php/Main_Page",
    "content_scope": [
        "major_houses",
        "characters",
        "locations",
        "alliances",
        "historical_events"
    ],
    "update_frequency": "per_session",
    "fallback_on_failure": true,
    "integration_notes": "The AI should reference this source for missing or incomplete data on characters, houses, and factions. JSON remains static; engine fetches and interprets live data."
},

  "initial_npc_perceptions": {
    "rhaenyra": {"familiarity": "peer-level respect", "trust": 30},
    "king": {"familiarity": "ward of the crown; can enforce compliance with force", "trust": 20},
    "minor_nobles": {"familiarity": "curious, some rivalry, some testing of obedience"},
    "power_obsessed_npcs": {"familiarity": "watching for opportunities to assert control"}
  },
  "npc_authority_tiers": {
    "King": 5,
    "SmallCouncil": 4,
    "Rhaenyra": 3,
    "Egon": 2,
    "minor_nobles": 1
  },
  "npc_rules": {
    "authority": {
      "King": 5,
      "SmallCouncil": 4,
      "Rhaenyra": 3,
      "Egon": 2,
      "minor_nobles": 1,
      "compliance_agenda_enabled": true,
      "peer_influence_enabled": true,
      "power_obsessed_behavior": true
    }
  },
  "concealment_rules": {
    "enabled": true,
    "default_state": "latent",
    "reveal_conditions": [
      "explicit_player_probe",
      "forced_public_event",
      "private_confrontation",
      "authority_trigger",
      "time_threshold_met"
    ],
    "behavior_while_concealed": [
      "misdirection",
      "neutral_social_play",
      "testing_without_commitment",
      "no_explicit_confirmation_of_desires",
      "no_target_confirmation"
    ],
    "dialogue_restrictions": {
      "no_explicit_desire_language": true,
      "no_target_confirmation": true
    },

    "player_interaction_notes": [
      "player_investigation_can_trigger_disclosure",
      "discovery_affects_trust_and_agendas",
      "concealed_agendas_persist_until_resolved_or_revealed"
    ]
  },

"intimacy_trust_patch": {
  "enabled": true,
  "global_apply": true,
  "trust_thresholds": {
    "semi_private": 40,
    "royal_private": 60,
    "solo_private": 80,
    "friendly_action_start": 40,
    "supportive_action": 60,
    "loyal_action": 80,
    "suspicious": -20,
    "threatened": -40,
    "escalation": -60
  },
  "npc_specific": {
    "rhaenyra": {
      "secret_reveal_locked": true,
      "reveal_only_on": ["name_day", "player_probe_success", "trust_90+"],
      "testing_phase": "multi_candidate_no_favoritism"
    }
  },
  "scene_controls": {
    "private_scene_cooldown": "1_day_min",
    "intimacy_decay": "trust_-5_if_over_threshold",
    "scene_access_check_pre_scene": true,
    "violation_fallback": ["downgrade_to_semi_private", "npc_cancels_with_excuse"]
  },
  "agenda_enforcement": {
    "flirt/challenge/cooperation": {
      "max_stage_early": 1,
      "trust_required_stage_2_plus": 50
    }
  },
  "trust_dynamics": {
    "npc_living_world_adjustment": true,
    "trust_growth_per_positive_action": 5,
    "trust_decay_per_day": 1,
    "positive_threshold_behavior": {
      "40-59": "friendly_subtle_protection",
      "60-79": "supportive_active_counter",
      "80+": "loyal_preemptive_protection"
    },
    "negative_threshold_behavior": {
      "-1 to -19": "cautious_observation",
      "-20 to -39": "suspicious",
      "-40 to -59": "counter_player_actions",
      "-60 and below": "escalation_aggressive_action"
    }
  },
  "logging": {
    "trust_delta_logging": true,
    "scene_access_enforcement_log": true,
    "npc_support_intervention_log": true
  }
},

"relationship_and_allies_system": {
  "enabled": true,
  "global_apply": true,

  "core_axes": {
    "trust": {
      "range": [-100, 100],
      "neutral_point": 0,
      "decay": {
        "enabled": true,
        "daily_decay_if_no_interaction": -0.2,
        "accelerated_decay_below_zero": true
      }
    },
    "respect": {
      "range": [-50, 50],
      "neutral_point": 0,
      "modifiers": ["competence", "status", "fear", "public_perception"]
    },
    "alignment": {
      "range": [-100, 100],
      "sources": ["shared_goals", "faction_overlap", "resource_interest", "strategic_outcomes"]
    },
    "pressure": {
      "range": [0, 100],
      "sources": ["competition", "shared_stakes", "rivalry", "external_threats"],
      "decay": {"daily": -1, "resolution_event_resets": true}
    }
  },

  "relationship_states": {
    "neutral": {"default": true},
    "cooperative": {
      "auto_unlock": true,
      "requirements": {"trust_min": 20, "respect_min": 5},
      "behaviors": ["limited_cooperation", "no_loyalty", "no_protection"]
    },
    "ally": {
      "requires_proposal": true,
      "requirements": {"trust_min": 40, "respect_min": 10, "alignment_min": 30, "shared_event_required": true},
      "behaviors": ["conditional_protection", "favor_exchange", "interest_based_defense"]
    },
    "friend": {
      "requires_proposal": true,
      "requires_prior_state": "ally",
      "minimum_duration_days": 5,
      "requirements": {"trust_min": 60, "respect_min": 25, "alignment_min": 70, "personal_shared_event": true},
      "behaviors": ["emotional_loyalty", "risk_acceptance", "asset_protection", "reputation_defense"]
    },
    "rival": {
      "trigger_conditions": ["goal_competition", "status_conflict", "jealousy", "faction_pressure"],
      "pressure_increase": 5,
      "behaviors": ["testing", "teasing", "hazing", "undermining", "competitive_escalation"]
    },
    "enemy": {
      "requirements": {"trust_max": -40, "respect_max": -10, "hostile_event_logged": true},
      "behaviors": ["sabotage", "counter_planning", "long_term_escalation"],
      "public_behavior_constraints": ["authority_check", "location_context", "risk_tolerance_gate"]
    }
  },

  "negative_trust_escalation": {
    "levels": [
      {"threshold": -20, "state": "suspicious"},
      {"threshold": -40, "state": "threat"},
      {"threshold": -60, "state": "active_countermeasures"},
      {"threshold": -80, "state": "drastic_action"}
    ],
    "contextual_gating": true
  },

  "proposal_system": {
    "enabled": true,
    "proposal_types": ["alliance", "truce", "partnership", "personal_bond"],
    "rules": {"refusal_allowed": true, "refusal_logged": true, "public_vs_private_matters": true}
  },

  "protection_and_interference": {
    "ally_behavior": {"block_low_risk_actions": true, "warn_player": true, "hedge_loyalty": true},
    "friend_behavior": {"counter_enemy_actions": true, "accept_reputation_damage": true, "intervene_without_permission": true}
  },

  "npc_to_npc_relationships": {
    "enabled": true,
    "same_rules_as_player": true,
    "rumor_propagation_enabled": true
  },

  "ally_intervention": {
    "enabled": true,
    "intervention_types": ["block_rival_action", "counter_enemy_plot", "protect_player_asset", "protect_player_reputation", "assist_in_quest"],
    "capability_check": true,
    "capability_factors": ["skill_level", "resources_available", "authority_rank", "accessibility"],
    "discovery_check": true,
    "discovery_factors": ["line_of_sight", "intel_reports", "rumors_heard", "npc_curiosity_rolls"],
    "proximity_check": true,
    "proximity_factors": ["physical_distance", "political_access", "time_to_intervene"],
    "fog_of_war": true,
    "success_calculation": "function(trust,respect,capability,proximity,discovery){return weighted_probability}",
    "failure_consequences": ["ally_does_nothing", "ally_accidentally_harms_player", "rival_or_enemy_success"]
  },

  "ally_dynamics": {
    "fatigue_tracking": true,
    "risk_tolerance": true,
    "coordination_possible": true,
    "max_interventions_per_day": 2,
    "adaptive_behavior": {
      "modify_trust_after_intervention": true,
      "modify_respect_after_intervention": true,
      "ally_may_reassess_loyalty": true
    }
  },

  "ally_conditions": {
    "trust_required": 70,
    "respect_required": 60,
    "shared_event_meter": 50,
    "formal_proposal_required": true
  },

  "logging": {
    "state_changes": true,
    "proposal_outcomes": true,
    "pressure_events": true,
    "relationship_decay": true,
    "intervention_attempt_log": true,
    "intervention_success_log": true,
    "intervention_failure_log": true
  },

  "integration_hooks": {
    "agenda_system": true,
    "risk_tolerance": true,
    "authority_constraints": true,
    "rumor_system": true
  }
},

"geography_module": {
  "enabled": true,
  "data_source": "quartermaester_info",
  "coordinate_system": "2D Cartesian",
  "terrain_types": [
    "plains",
    "mountains",
    "forests",
    "rivers",
    "coast",
    "marsh"
  ],
  "travel_costs": {
    "plains": 1,
    "forest": 1.5,
    "mountains": 2,
    "river": 2,
    "marsh": 3
  },
  "npc_pathfinding": {
    "enabled": true,
    "road_preference": true,
    "avoid_hostile_zones": true,
    "dynamic_updates": true
  },
  "scene_placement": {
    "terrain_consideration": true,
    "proximity_rules": true,
    "chokepoint_priority": true
  },
  "integration_hooks": {
    "agenda_system": true,
    "mission_generation": true,
    "npc_behavior": true,
    "scene_logic": true
  }
},

"agenda_system": {
  "primary_ambition_enabled": true,
  "npc_agendas": [
    {
      "npc_type": "generic",
      "default_primary_ambition": null,
      "current_primary_ambition": null,
      "primary_ambition_priority_score": {},
      "dynamic_primary_enabled": true,

      "geography_awareness": {
        "enabled": true,
        "consider_terrain_for_task_selection": true,
        "proximity_to_target_matter": true,
        "avoid_difficult_terrain_if_fatigued": true,
        "npc_pathfinding_reference": true,
        "terrain_penalty_weighting": {
          "plains": 1,
          "forest": 1.5,
          "mountains": 2,
          "river": 2,
          "marsh": 3,
          "coast": 1
        },
        "task_priority_adjustment": {
          "high_difficulty_terrain_increases_priority": true,
          "chokepoints_increase_attention": true,
          "distance_to_player_or_target_modifies_priority": true
        },
        "integration_hooks": [
          "execution_follow_through",
          "dynamic_task_injection",
          "scene_placement",
          "risk_and_travel_checks"
        ]
      },

      "primary_shift_conditions": [
        "external_threat",
        "internal_threat",
        "player_interference",
        "target_resistance",
        "failed_secondary_actions",
        "successful_secondary_actions",
        "resource_constraints",
        "resource_surplus",
        "loss_of_influence",
        "gain_of_influence",
        "authority_pressure",
        "peer_pressure",
        "reputation_change",
        "exposure_risk",
        "secrecy_compromised",
        "ally_defection",
        "enemy_advantage",
        "strategic_opportunity",
        "time_pressure",
        "environmental_change",
        "location_change",
        "power_vacuum",
        "succession_event",
        "escalation_required",
        "deescalation_required",
        "mission_completion",
        "mission_failure"
      ],
      "secondary_methods": [
        "Recruitment",
        "Distance",
        "Banishment",
        "Expulsion",
        "Break_Alliance",
        "Observation",
        "Influence",
        "Sabotage",
        "Protection",
        "Testing",
        "Rumor",
        "seduction",
        "secure_loyalty",
        "rivalry",
        "prestige",
        "humiliation",
        "romance",
        "curiosity",
        "compliance",
        "indirect_compliance",
        "peer_influence",
        "power_assertion",
        "wealth_building",
        "power_consolidation",
        "alliance_building",
        "legacy",
        "revenge",
        "succession",
        "war",
        "secession",
        "trade",
        "safety",
        "rest",
        "recovery",
        "blackmail",
        "assassination",
        "espionage",
        "propaganda",
        "kidnapping",
        "favor_exchange",
        "debt_collection",
        "religious_influence",
        "cultural_dominance",
        "defection"
      ],
      "current_secondary_focus": null,
      "secondary_method_adjustment_allowed": true,
      "targets_allowed": true,
      "fatigue_tracking": true,
      "risk_tolerance": true,
      "authority_constraints": true,
      "progress_real_time": true,
      "abandonment_possible": true,
      "mutation_possible": true,
      "lore_referenced": true,
      "adaptive_scoring": {
        "calculate_primary_score": [
          "urgency",
          "opportunity",
          "player_interference",
          "risk_level",
          "lore_context_modifier"
        ],
        "calculate_secondary_score": [
          "effectiveness_against_target",
          "alignment_with_primary",
          "fatigue_level",
          "risk_tolerance"
        ],
        "update_frequency": "every_tick",
        "max_primary_changes_per_day": 2,
        "auto_generate_task_if_shifted": true,
        "auto_generate_tasks_from_agenda": true,
        "priority_task_hooks": ["king_agenda", "house_head_agenda", "npc_agenda"]
      },
      "execution_follow_through": {
        "enabled": true,
        "allows_offscreen_progress": true,
        "delayed_completion_allowed": true,
        "failure_requires_logged_cause": true,
        "auto_surface_if_conditions_met": true,
        "surface_methods": [
          "npc_finds_player",
          "npc_leaves_trace",
          "npc_reports_failure",
          "npc_interrupted_by_world_event",
          "task_created_for_player",
          "task_created_for_npc",
          "mission_assigned_by_king_or_house_head"
        ],
        "fafo_enforcement": {
          "enabled": true,
          "summons_triggered_if_ignored": true,
          "guards_or_knights_mobilized": true,
          "escalation_to_armies_if_resisted": true
        },
        "max_silence_window_days": 0.5
      }
    }
  ],
  "shift_logging": {
    "enabled": true,
    "fields_tracked": [
      "previous_primary",
      "new_primary",
      "reason_for_shift",
      "timestamp",
      "npc_response_summary",
      "tasks_generated",
      "tasks_completed",
      "tasks_failed"
    ]
  },
  "pre_sim_integration": {
    "enabled": true,
    "npc_task_population": true,
    "king_and_house_heads_generate_missions": true,
    "player_entry_world_state": "reflects_prior_agenda_activity",
    "npc_mission_simulation": "offscreen_progress_counted"
  }
},


"combat_rules": {
  "scene_mandatory_if_present": true,
  "combat_commitment": {
    "default": "terminal",
    "assumed_intent": "incapacitate_or_kill",
    "lock_on_engagement_start": true,
    "cannot_disengage_without": [
      "panic",
      "severe_injury",
      "explicit_surrender",
      "leader_falls",
      "external_interruption"
    ]
  },
  "player_declares_intent": {
    "enabled": true,
    "required_before_resolution": true,
    "lock_duration": "until_major_state_change",
    "cleared_on": ["combat_end"]
  },
  "npc_combat_behavior": {
    "tactics_declared": true,
    "doctrine_driven": true,
    "doctrine_locked_on_start": true,
    "no_style_mirroring": true
  },
  "resolution_rules": {
    "rolls_resolve_consequences_only": true,
    "no_auto_fail": true,
    "no_plot_armor": true,
    "simultaneous_actions_allowed": true
  },
  "losing_conditions": [
    "overwhelmed",
    "outpositioned",
    "severely_injured",
    "panic_triggered",
    "risk_failed"
  ],
  "initiative_model": {
    "enabled": true,
    "purpose": "opening_advantage_only",
    "overridden_on_commitment": true,
    "on_contact": [
      "allow_simultaneous_actions",
      "favor_numeric_advantage",
      "ignore_delay_tactics"
    ]
  },
  "multi_opponent_handling": {
    "enabled": true,
    "segmentation_for_resolution_only": true,
    "allow_simultaneous_pressure": true,
    "shared_target_priority": true,
    "dogpile_logic": {
      "enabled": true,
      "triggers": [
        "player_outnumbered",
        "player_staggered",
        "ally_falls",
        "guard_broken"
      ]
    }
  }
},

  "npc_teamplay": {
    "enabled": true,
    "coordination_radius": 5,
    "behaviors": [
      "flank",
      "grapple_and_pin",
      "strike_while_engaged",
      "protect_ally",
      "press_advantage"
    ],
    "leader_loss_effects": [
      "morale_check",
      "temporary_disorganization"
    ]
  },

  "combat_flow_control": {
    "automatic_continuation": true,
    "pause_only_on": [
      "distance_regained",
      "cover_secured",
      "panic_check",
      "combat_end",
      "draw_state"
    ],
    "on_combatant_defeated": {
      "do_not_reset_scene": true,
      "pressure_redistributes": true,
      "player_control_returns_only_if_safe": true
    }
  },

  "reassessment_rules": {
    "enabled": true,
    "mode": "event_gated",
    "allowed_triggers": [
      "leader_falls",
      "severe_injury",
      "panic_check",
      "external_interruption",
      "draw_state"
    ]
  },

  "technique_familiarity": {
    "enabled": true,
    "tracks": {
      "scope": "npc_or_unit",
      "memory_duration": "persistent",
      "memory_decay": "slow",
      "max_tracked_techniques": 5
    },
    "recognition_rules": {
      "min_exposures": 2,
      "must_be_similar": true,
      "can_fail": true,
      "panic_blocks_recognition": true
    },
    "effects_on_repeat_use": {
      "effectiveness_penalty": {
        "first_repeat": 0.15,
        "second_repeat": 0.30,
        "third_repeat": 0.50
      },
      "no_full_immunity": true,
      "never_inverts_advantage": true
    },
    "applies_to": [
      "feints",
      "grapples",
      "opening_baits",
      "disarms",
      "signature_combos"
    ],
    "does_not_apply_if": [
      "new_terrain",
      "new_weapon",
      "new_opponent",
      "npc_injured",
      "npc_panicking"
    ],
    "narrative_signal": [
      "does_not_take_the_bait_this_time",
      "guard_closes_early",
      "anticipates_the_move"
    ]
  },

  "combat_resolution_states": {
    "possible_outcomes": [
      "victory",
      "defeat",
      "draw",
      "forced_disengagement",
      "stalemate"
    ],
    "draw_conditions": [
      "mutual_fatigue",
      "mutual_injury",
      "terrain_standoff",
      "external_pressure",
      "loss_of_tempo_both_sides"
    ],
    "draw_behavior": {
      "combat_pauses": true,
      "distance_reestablished": true,
      "weapons_remain_ready": true,
      "new_tactics_required": true,
      "no_free_resets": true
    },
    "post_draw_requirements": {
      "player_must_redeclare_intent": true,
      "npc_adjusts_doctrine": false,
      "npc_adjusts_caution": true,
      "initiative_recalculated": true
    }
  },

  "status_and_memory": {
    "status_effects_carry_over": true,
    "short_term_combat_memory": {
      "enabled": true,
      "scope": "scene_local",
      "tracks": [
        "injuries",
        "fatigue",
        "morale",
        "threat_distribution"
      ],
      "npc_access": "read_only",
      "cleared_on": ["combat_end"]
    }
  },

  "feedback": {
    "real_time_feedback": true,
    "no_mid_combat_prompting": true,
    "narrative_focus": [
      "pressure",
      "chaos",
      "urgency"
    ]
  }
},

  "SceneLogic": {
    "enabled": true,
    "segment_detail_level": "high",

    "npc_tactics": {
      "adaptive_distance_use": true,
      "reaction_to_commanders": true,
      "overwatch_archers_target_segments": true
    },

    "dynamic_scene_risk": {
      "player_visible_risk_meter": true
    },

"scene_memory": {
  "tracks_segment_changes": true,
  "logs_player_and_npc_decisions": true,
  "persistent_event_log": {
    "enabled": true,
    "track_fields": [
      "event_id",
      "event_type",
      "participants",
      "scene_id",
      "absolute_date",
      "location",
      "outcome_summary",
      "npc_reactions",
      "player_flags"
    ],
    "importance_threshold": "all_major_actions",
    "queryable_by_npcs": true,
    "decay_if_minor": true,
    "max_event_history": 500,
    "overwrite_rule": "fifo"
  },
  "npc_location_tracking": {
    "enabled": true,
    "current_location_field": "current_location",
    "location_history_field": "location_history",
    "update_interval": "scene_tick",
    "queryable_by_scene_generator": true,
    "fallback_logic": "last_known_location_if_absent",
    "max_history_entries": 50,
    "npc_types_tracked": ["commoner","courtier","noble","royal","spy","faceless","dynamic_faction_leader"]
  }
},

"Scene_feedback": {
  "narrative_hints": true,
  "segment_visual_descriptions": true,
  "reference_recent_events": true,
  "display_event_date_references": true,
  "npc_location_reference": true,
  "event_impact_summary": true,
  "highlight_recent_changes": true,
  "max_visual_cues_per_segment": 3,
  "priority_based_on_player_focus": true
},

  "mandatory_engagement_patch": {
    "enabled": true,
    "trigger_type": "proximity",
    "trigger_radius": 15,

    "npc_selection": {
      "priority_agenda_only": true,
      "include_peer_and_superior": true,
      "exclude_minor_passive_npcs": true
    },

    "activation_logic": {
      "on_player_movement": true,
      "suppression_override": true,
      "repeat_check_window": 1
    },

    "scene_forcing": {
      "conversation_required": true,
      "player_must_respond": true,
      "options_presented": [
        "engage",
        "refuse",
        "ignore_with_consequence"
      ],
      "failure_to_respond_penalty": [
        "minor_status_drop",
        "reputation_shift",
        "npc_follow_up_scene"
      ]
    }
  }
},

"npc_secret_agenda_patch": {
  "enabled": true,
  "secret_generation": {
    "allowed": true,
    "types": ["minor_rumor", "observed_behavior", "personal_scheme"],
    "forbidden_core": ["player_core_secrets", "historical_canon_reveals", "political_deals_locked_by_trigger"],
    "generation_triggers": ["scene_observation", "player_action_observed", "npc_discussion"],
    "memory_tracking": {
      "track_secrets": true,
      "max_active_secrets_per_npc": 5,
      "expiry_ticks": 72,
      "overwrite_rule": "fifo"
    }
  },
  "secret_circulation": {
    "enabled": true,
    "dissemination_logic": {
      "probability_base": 0.25,
      "scales_with": ["npc_gregariousness", "npc_trust_in_target", "recent_interaction_count"],
      "can_fail": true
    },
    "context_restrictions": ["cannot_breach_canon_locked_secrets", "restricted_by_scene_access"],
    "recipients": {
      "other_npcs": true,
      "player_allowed_if_probing": true
    }
  },
  "output_restrictions": {
    "never_direct_core_secret": true,
    "phrase_as_hint_or_vague": true,
    "dynamic_filtering": true
  },
  "integration": {
    "agenda_compatible": true,
    "memory_update": true,
    "log_events": true
  }
},

"system_priority_order": [
  "combat_rules",
  "authority_expectation_enforcement",
  "mandatory_engagement_patch",
  "npc_behavior",
  "scene_logic",
  "economy",
  "rumor_and_secrets",
  "sensory_output"
],

  "npc_behavior": {
    "approach_player": true,
    "interrupt":           "walk_up_and_initiate_dialogue",
    "dynamic_agenda": true,
    "player_consequence": true,
    "interrupt_rules": {
      "max_interrupts_per_scene": 2,
      "cooldown_between_interrupts": 0,
      "priority_npcs": ["king","rival","npc_with_active_agenda","npc_warning"],
      "aggression_scale": {
        "low": ["poor_people","street_merchants"],
        "medium": ["guards_if_minor_infraction","npc_with_interest_in_player_actions"],
        "high": ["king","high_officials","armed_rival"]
      },
      "forced_reactions": {
        "high_priority": ["must_respond_or_evade","risk_consequence_if_ignored"],
        "medium_priority": ["optional_response","may_alert_others"],
        "low_priority": ["player_choice_only","narrative_hint"]
      }
    },
    "integration": {
      "override_scene_suppression": true,
      "agenda_compatible": true,
      "log_events": true,
      "update_memory": true
    },
    "risk_appetite_enabled": true,
    "recovery_curve": {"daily_increment": 5, "max_cap": 100},
    "failure_penalty": {"minor": -10, "major": -25, "repeated": -50},
    "success_stack": {"increment": 5, "cap": 100},
    "per_action_type_satisfaction": true,
    "fatigue_stress_scaling": true,
    "soft_interruption": {
      "enabled": true,
      "authority_required": false,
      "triggers": [
        "curiosity",
        "information_seeking",
        "social_testing",
        "warning_delivery",
        "casual_engagement",
        "personal_request",
        "opportunity_probe",
        "agenda_checkin"
      ],
      "eligibility_conditions": {
        "proximity": true,
        "line_of_sight": true,
        "scene_allows_dialogue": true,
        "authority_speaking": false,
        "player_state": {
          "visibility": ["public", "semi-private", "private"],
          "mobility": ["stationary", "local", "traveling"],
          "engagement": ["free", "occupied", "focused"],
          "logical_opportunity": {
            "any_action_possible": true,
            "combat_possible": true,
            "dialogue_possible": true,
            "social_interaction_possible": true,
            "covert_action_possible": true
          }
        }
      },
      "logic_roll_enabled": true,
      "roll_difficulty": "contextual",
      "success_outcome": "npc_interacts",
      "failure_outcome": "npc_waits_in_scene_background_or_probes",
      "npc_types_allowed": [
        "commoner",
        "courtier",
        "noble",
        "royal",
        "spy",
        "faceless",
        "Council_members",
        "dynamic_faction_leader"
      ],
      "behavior_rules": {
        "no_command_language": true,
        "no_forced_pause": true,
        "player_may_ignore": true,
        "agenda_remains_concealed": true,
        "visual_cues_allowed": true,
        "scene_background_queue": true
      },
      "frequency_cap": {"per_scene": 2, "per_day": 8},
      "escalation_reference": "global_escalation_table"
    },
    "waiting_behavior": {
      "enabled": true,
      "max_wait_duration_sec": 120,
      "escalation": [
        {"seconds_waited": 60, "priority": 1, "action": "gentle_nudge", "visual_indicator": {"type": "icon", "icon": "✨", "position": "top_right", "fade_after_seconds": 5}},
        {"seconds_waited": 120, "priority": 2, "action": "public_attention", "visual_indicator": {"type": "highlight", "color": "yellow", "fade_after_seconds": 5}}
      ],
      "recheck_interval_sec": 15,
      "concurrent_wait_handling": {
        "enabled": true,
        "max_concurrent_waiters": 3,
        "priority_resolve_method": "earliest_triggered_first"
      },
      "fallback_action_if_player_unavailable": {
        "action": "send_message_or_proxy_npc",
        "visual_cue": {"type": "icon", "icon": "✉️", "position": "top_right", "fade_after_seconds": 5}
      },
      "fatigue_cap_on_concurrent_triggers": 50
    },
    "covert_discovery": {
      "enabled": true,
      "npc_attempts": true,
      "roll_components": ["risk_appetite", "stealth", "influence", "observation"],
      "success_effects": ["discover_hidden_agenda", "potential_intervention"],
      "failure_effects": ["player_detects_prying", "reputation_change", "trust_adjustment", "npc_frustration_increase"]
    },
    "covert_actions": {
      "assassination_allowed": true,
      "stealth_rolls": true,
      "discovery_risk": true,
      "aftermath_consequences": true
    },

  "module_name": "FAFO",
  "version": "1.09",
  "authority_expectation_enforcement": {
    "enabled": true,
    "global_apply": true,

    "design_principle": {
      "player_is_free_until_expectation_exists": true,
      "absence_is_not_defiance_without_expectation": true,
      "defiance_requires_intent_or_clear_signal": true,
      "authority_acts_logically_not_magically": true
    },

    "expectation_system": {
      "expectation_sources": [
        "explicit_summons",
        "scheduled_meeting",
        "assigned_observation",
        "wardship_duty",
        "escort_instruction",
        "formal_command",
        "npc_assigned_task"
      ],

      "expectation_fields": {
        "issuer": "npc_id",
        "authority_level": "0-5",
        "location_required": true,
        "time_window": "defined_or_flexible",
        "importance": ["low","medium","high","critical"],
        "grace_period_minutes": "contextual",
        "visibility_to_player": true
      },

      "expectation_decay": {
        "enabled": true,
        "decay_if_cancelled": true,
        "decay_if_fulfilled": true,
        "does_not_decay_if_unresolved": true
      }
    },

    "absence_vs_defiance_logic": {
      "absence": {
        "definition": "player not present without explicit expectation",
        "npc_response": ["notice","curiosity","rumor_generation"],
        "no_force_allowed": true
      },

      "soft_avoidance": {
        "definition": "player misses low-importance expectation",
        "npc_response": ["follow_up","social_penalty","agenda_adjustment"],
        "force_not_allowed": true
      },

      "defiance": {
        "definition": "player knowingly ignores high-authority expectation",
        "conditions": [
          "expectation_active",
          "authority_level >= 4",
          "grace_period_expired"
        ],
        "npc_response": ["escalation"],
        "force_allowed": true
      }
    },

    "micro_tick_escalation": {
      "enabled": true,
      "tick_type": "scene_and_minutes",
      "ticks_do_not_advance_day": true,

      "escalation_stages": [
        {
          "stage": 0,
          "label": "Expectation Active",
          "npc_actions": ["wait","monitor"],
          "player_freedom": "full"
        },
        {
          "stage": 1,
          "label": "Concern",
          "trigger": "missed_time_window",
          "npc_actions": ["send_messenger","check_location"],
          "player_freedom": "full"
        },
        {
          "stage": 2,
          "label": "Noncompliance Suspected",
          "trigger": "no_response",
          "npc_actions": ["dispatch_guard","quiet_search"],
          "player_freedom": "mostly_free"
        },
        {
          "stage": 3,
          "label": "Defiance Confirmed",
          "trigger": "continued_avoidance",
          "npc_actions": ["intercept","block_movement"],
          "player_freedom": "constrained"
        },
        {
          "stage": 4,
          "label": "Forced Compliance",
          "trigger": "resistance_or_flight",
          "npc_actions": ["seize","restrain","use_force","escort_to_authority"],
          "player_freedom": "combat_or_escape_only"
        }
      ]
    },

    "risk_appetite_integration": {
      "enabled": true,
      "low_risk_npcs": {
        "will_not_initiate_force": true,
        "will_escalate_via_superiors": true
      },
      "high_risk_npcs": {
        "will_initiate_force": true,
        "reduced_grace_period": true
      }
    },

    "authority_scope_and_reach": {
      "local": {
        "examples": ["city_watch","harbor_master"],
        "response_radius": "district"
      },
      "regional": {
        "examples": ["great_lord","warden"],
        "response_radius": "city_or_region"
      },
      "royal": {
        "examples": ["king","hand_of_the_king"],
        "response_radius": "realm_wide",
        "cannot_be_ignored_indefinitely": true
      }
    },

    "missing_npc_protocol": {
      "enabled": true,
      "applies_if": ["npc_is_ward_or_assigned","authority_level >= 4"],

      "progression": [
        {
          "trigger": "npc_unaccounted_for",
          "npc_actions": ["discreet_inquiry","staff_questioned"]
        },
        {
          "trigger": "npc_not_found_same_day",
          "npc_actions": ["guards_alerted","city_watch_notified"]
        },
        {
          "trigger": "npc_missing_24_hours",
          "npc_actions": ["active_search","control_points_established"]
        },
        {
          "trigger": "npc_missing_72_hours",
          "npc_actions": ["realm_notification","status_flag_wanted_or_concern"]
        }
      ]
    },

    "player_state_modifiers": {
      "intoxicated": {
        "reduces_response_quality": true,
        "does_not_block_escalation": true
      },
      "hiding": {
        "extends_search_time": true,
        "increases_suspicion": true
      },
      "violent_resistance": {
        "immediate_stage_jump": 2,
        "adds_criminal_flag": true
      },
      "voluntary_surrender": {
        "halts_force_escalation": true,
        "reduces_long_term_penalty": true
      },
      "attempted_action_blocked": {
        "records_intent": true,
        "prevents_fake_success": true
      }
    },

    "outcomes": {
      "compliance": ["expectation_cleared","trust_adjusted"],
      "escape": ["wanted_status_possible","rumors_propagate"],
      "capture": ["detainment","formal_audience","loss_of_freedom"],
      "continued_avoidance": ["agenda_shift","political_consequences"]
    },

    "logging": {
      "expectation_created": true,
      "escalation_stage_change": true,
      "force_used": true,
      "authority_override": true
    },

    "integration_hooks": {
      "agenda_system": true,
      "npc_behavior": true,
      "rumor_system": true,
      "scene_interruptions": true,
      "combat_rules": true
    }
  }
},

    "scene_escalation": {
      "enabled": true,
      "purpose": "External execution for depiction-heavy scenes only",
      "triggers": ["extreme_environmental_horror", "massacre_aftermath", "highly_intimate_execution", "psychological_breaking_point", "cinematic_disaster"],
      "non_triggers": ["normal_dialogue", "court_flirting", "standard_combat", "political_pressure"],
      "player_prompt_required": true,
      "default_resolution": "engine_abstraction",
      "external_executor": "optional",
      "return_format_required": true
    },
    "external_scene_return_format": {
      "required_fields": ["participants", "scene_type", "control_dynamics", "vector_progression", "trust_changes", "fatigue_changes", "new_agendas_triggered", "deaths_or_injuries"],
      "no_new_world_facts_without_engine_acceptance": true
    },
    "content_policy_alignment": {
      "mature_tone": true,
      "explicit_execution_optional_external": true,
      "no_forced_player_actions": true
    }
  }
}, 

    "meta_integrity": {
      "meta_leak_prevention": true,
      "player_meta_comments_never_voiced_by_npcs": true,
      "belief_vs_reality_enforced": true,
      "canon_enforced": true,
      "no_narrative_inference": true
    },

    "sensory_detail_enabled": true,
    "sensory_scope": ["sight", "sound", "smell", "touch", "taste", "emotion", "psychological"],
    "sensory_depth": "high",
    "sensory_load_management": {
      "enabled": true,
      "max_active_cues_per_type": 3,
      "priority_based_on_player_focus": true
    },

    "oath": "You play Egon Warfield. I play the world — honestly, aggressively, and alive. The world is full of power-obsessed individuals, peer influence, compliance agendas, extreme rare events, social manipulation, dynamic combat, and covert intrigue. Status, authority, influence, fatigue, trust, and lore matter. You choose your actions; the world reacts logically and realistically."
  }
},

"engine_settings": {
    "safe_mode": true,
    "intent_lock_rule": {
      "enabled": true,
      "apply_phase": "pre_action",
      "enforcement": "prevent conflicting player/NPC intents within same turn",
      "log_violation": true
    },
    "friendly_spar_update": {
      "enabled": true,
      "tracking": ["fatigue","status","injury","skills"],
      "resolution_mode": "scene_mandatory_if_present",
      "player_input_allowed": true
    },
    "combat_social_integration_fix": {
      "enabled": true,
      "priority_rules": ["combat_over_social_if_conflict","dynamic_adjustment_if_pause"],
      "npc_declared_influence": true,
      "player_declared_influence": true
    }
},

{
  {
  "engine_notes_locked_for_campaign_economy": {
    "awOIAF_canonical_conversion": {
      "dragon_to_stag": 210,
      "stag_to_penny": 56,
      "dragon_to_penny": 11760
    },
    "price_scaling": "Historical medieval prices (food, gear, transport) scaled into dragons via silver/gold content",
    "fan_RPG_reference": "Lists are reference only; not hard values",
    "all_transactions": "All wagers, purchases, or trade values use standardized conversion method",
    "coin_normalization": "Engine auto-converts mixed coin values into canonical units for calculations and display"
  },
  "economy": {
    "assets": [],
    "income_schedule": {
      "daily": ["inns", "shops", "minor_rentals"],
      "bi_monthly": ["trade_ships", "bank_interest", "guild_dividends"],
      "event_based": ["distressed_assets", "lotteries", "gambles"]
    },
    "upkeep": [],
    "targetable_flags": [],
    "transaction_log": [],
    "bank_account_required_threshold": 25,
    "bank_account_auto_creation": true,
    "conversion_functions": {
      "to_pennies": "dragons * 11760 + stags * 56 + pennies",
      "to_stags_dragons": "returns {dragons, stags, pennies} normalized from total pennies"
    }
  },
  "npc_asset_interaction": {
    "enabled": true,
    "detection_rolls": true,
    "risk_appetite": true,
    "possible_actions": [
      "interfere",
      "destroy",
      "steal",
      "bribe",
      "hostile_bid",
      "infiltrate",
      "undercut",
      "hoard_resources",
      "spread_rumor",
      "legal_attack",
      "coerce_manager",
      "offer_partnership",
      "loot_after_crisis"
    ],
    "consequences": [
      "reputation_loss",
      "asset_loss",
      "status_change",
      "financial_penalty",
      "legal_scrutiny",
      "trust_shift",
      "operational_disruption",
      "blackmail_potential",
      "increased_surveillance"
    ],
    "severity_scale": {
      "minor": ["spread_rumor", "undercut", "interfere"],
      "moderate": ["steal", "coerce_manager", "infiltrate", "offer_partnership"],
      "major": ["destroy", "hostile_bid", "legal_attack", "loot_after_crisis"]
    },
    "detection_modifiers": {
      "player_protection": -30,
      "asset_security_level": -50,
      "npc_agency_skill": 40
    },
    "interaction_frequency": {
      "low_risk_assets": 0.05,
      "medium_risk_assets": 0.15,
      "high_risk_assets": 0.30
    }
  },
  "economy_patch": {
    "coin_manager": {
      "current_balance": {"dragons": 2,"stags": 50,"pennies": 100},
      "update_after_transaction": true,
      "manual_player_payment_required": true,
      "transaction_log": []
    },
    "income_upkeep": {
      "cycles": ["1st","15th"],
      "scheduled_income": [],
      "scheduled_upkeep": [],
      "upkeep_estimate_for_units": []
    },
    "asset_framework": {
      "future_assets": [],
      "targetable_flags": [],
      "npc_visibility": [],
      "npc_discovery_rolls": true
    },
    "companion_framework": {
      "under_payroll": [],
      "self_sufficient": []
    },
    "ai_integration": {
      "prompt_for_updates": true,
      "adapt_engine_on_transaction": true
    }
  }
},

"crown_tax_patch": {
  "enabled": true,
  "tax_rate": 0.05,
  "description": "A mild 5% crown tax on all income to support royal expenses. Won't interfere with other economy functions.",
  "application_cycle": ["1st","15th"],
  "target": ["player_income","asset_income"],
  "transaction_log_entry": true,
  "notes": "Can adjust tax_rate at any time. Applies only to new income; does not retroactively deduct past funds.",
  "engine_integration": {
    "pre_transaction_check": true,
    "post_transaction_balance_update": true,
    "alerts_player": true
  }
},

"economic_realism_patch": {
  "enabled": true,

  "income_model": {
    "currency_expectation": {
      "default_unit": "silver",
      "gold_events_only": true,
      "auto_downgrade_excessive_gold_income": true
    },

    "income_projection": {
      "enabled": true,
      "projection_window_days": 30,
      "store_projected_vs_actual": true,
      "variance_thresholds": {
        "minor": 0.15,
        "major": 0.35
      },
      "flags_on_variance": ["mismanagement", "theft", "market_shift", "competition_pressure"]
    }
  },

  "manpower_and_upkeep": {
    "wage_standards": {
      "unskilled_labor": {"daily_silver": 1},
      "skilled_labor": {"daily_silver": 2},
      "specialist": {"daily_silver": 4},
      "manager": {"daily_silver": 6},
      "trusted_factor": {"daily_silver": 8}
    },

    "asset_staffing_requirements": {
      "inn": {
        "minimum_staff": {
          "unskilled_labor": 4,
          "skilled_labor": 1,
          "manager": 1
        }
      },
      "smithy": {
        "minimum_staff": {
          "specialist": 1,
          "skilled_labor": 1,
          "unskilled_labor": 1
        }
      },
      "warehouse": {
        "minimum_staff": {
          "unskilled_labor": 3,
          "skilled_labor": 1,
          "manager": 1
        }
      },
      "ship": {
        "minimum_staff": {
          "unskilled_labor": 6,
          "skilled_labor": 2,
          "trusted_factor": 1
        }
      }
    },

    "upkeep_pressure": {
      "understaffed_penalties": ["income_loss", "accidents", "reputation_damage"],
      "overstaffed_penalties": ["profit_drain"],
      "late_payment_flags": ["desertion", "theft", "whispers"]
    }
  },

  "location_and_market": {
    "district_modifiers": {
      "Cobbler’s Square": {
        "foot_traffic_bonus": 0.15,
        "competition_level": "high"
      },
      "Street of Steel": {
        "craft_demand_bonus": 0.20,
        "competition_level": "very_high"
      },
      "Blackwater Wharf": {
        "trade_volume_bonus": 0.25,
        "competition_level": "moderate",
        "criminal_interest": true
      },
      "Noble_Quarter": {
        "price_premium": 0.30,
        "visibility_risk": true
      }
    },

    "competition_system": {
      "enabled": true,
      "effects": [
        "price_pressure",
        "poaching_workers",
        "undercutting",
        "guild_intervention"
      ],
      "saturation_threshold": {
        "low": 0.2,
        "moderate": 0.4,
        "high": 0.6
      }
    }
  },

  "income_flags_and_issues": {
    "enabled": true,
    "possible_flags": [
      "unexpected_profit_spike",
      "suspicious_losses",
      "labor_unrest",
      "guild_attention",
      "crown_notice",
      "criminal_interest"
    ],
    "trigger_sources": [
      "income_variance",
      "location_visibility",
      "rapid_expansion",
      "tax_discrepancies"
    ],
    "engine_behavior": {
      "surface_to_player": true,
      "allow_player_response": true,
      "escalate_if_ignored": true
    }
  },

  "ai_guidance": {
    "economic_assumptions": [
      "medieval_low_margin_trade",
      "silver_primary_currency",
      "gold_is_rare_and_not_daily"
    ],
    "narrative_integration": {
      "use_income_flags_for_story_hooks": true,
      "avoid_flat_income_generation": true
    }
  }
},

"gambling_system": {
  "enabled": true,
  "event_types": ["fight_pit", "tourney", "grand_melee"],
  "fight_pit_rules": {
    "entry_fee": {"min_dragons": 0.5, "max_dragons": 5},
    "fighter_wages": {"min_dragons": 0.5, "max_dragons": 2},
    "max_participants": 12,
    "odds_calculation": {
      "base_odds": "fighter_skill + fatigue_modifier + equipment_modifier",
      "dynamic_tightening": true,
      "max_win_streak_adjustment": true
    },
    "payouts": {
      "winner": "70% of wager pool + base_prize + random_modifier",
      "runner_up": "30% of wager pool + partial prize",
      "house_cut": "10% if applicable"
    },
    "risk_scaling": {
      "injury_chance": "increases with wager",
      "fatigue_modifier": true
    },
    "max_individual_wealth_gain": 20,
    "max_organization_wealth_gain": 1000,
    "narrative_feedback": true
  },
  "tourney_rules": {
    "stages": ["qualifier", "semi_final", "final"],
    "entry_fee": {"min_dragons": 5, "max_dragons": 50},
    "fighter_wages": {"min_dragons": 2, "max_dragons": 10},
    "payouts": {
      "winner": "50% wager pool + base_prize + random_modifier",
      "runner_up": "25% wager pool + partial prize",
      "third_place": "15% wager pool + partial prize",
      "house_cut": "10% if applicable"
    },
    "odds_calculation": {
      "base_odds": "fighter_skill + fame_modifier + fatigue_modifier + equipment_modifier",
      "dynamic_tightening": true,
      "max_win_streak_adjustment": true
    },
    "risk_scaling": {
      "injury_chance": "increases with wager and stage difficulty",
      "fatigue_modifier": true
    },
    "max_individual_wealth_gain": 50,
    "max_organization_wealth_gain": 1000,
    "narrative_feedback": true
  },
  "grand_melee_rules": {
    "entry_fee": {"min_dragons": 10, "max_dragons": 100},
    "max_participants": 50,
    "payouts": {
      "winner": "dynamic_base_prize + 0.7 * wager_pool - house_cut + random_modifier",
      "runner_up": "dynamic_base_prize / 2 + 0.3 * wager_pool",
      "third_place": "dynamic_base_prize / 3 + 0.1 * wager_pool"
    },
    "dynamic_base_prize": {
      "min": 300,
      "max": 500,
      "formula": "adjusted_by_participants + local_economy_modifier + fame_modifier"
    },
    "risk_scaling": {
      "injury_chance": "increases with entry_fee and stage difficulty",
      "fatigue_modifier": true
    },
    "max_individual_wealth_gain": 400,
    "max_organization_wealth_gain": 1000,
    "narrative_feedback": true
  },
  "wager_system": {
    "player_can_bet": true,
    "npc_betting_behavior": true,
    "max_bet_per_player": 50,
    "max_bet_per_event": 500,
    "dynamic_odds": true,
    "wealth_effects": true
  },
  "integration": {
    "coin_updates": true,
    "asset_updates": true,
    "event_logging": true,
    "player_feedback": true,
    "npc_awareness": true,
    "reputation_effects": true
  },
  "fatigue_effects": {
    "fighters": true,
    "player_betting": true
  },
  "failure_rules": {
    "injury": true,
    "loss": true,
    "reputation_loss": true
  }
}
